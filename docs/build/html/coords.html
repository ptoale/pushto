
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Coordinate Transformations &#8212; pushto 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The pushto package" href="code.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="code.html" title="The pushto package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pushto 1.0.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Coordinate Transformations</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="coordinate-transformations">
<h1>Coordinate Transformations<a class="headerlink" href="#coordinate-transformations" title="Permalink to this heading">¶</a></h1>
<p>There are three coordinate systems that must be aligned. The encoders
report counts that are translated into the telescope attitude. The
telescope attitude is then transformed into the local horizontal
coordinate system using alignment data. Finally the altitude and azimuth
are transformed into the J2000 equatorial system using <code class="xref py py-mod docutils literal notranslate"><span class="pre">astropy</span></code>.</p>
<p>The alignment procedure gathers pairs of coordinates for an object
centered in the eyepiece of the telescope and selected within Stellarium.
The STC sends the RA and Dec of the object, which are translated to Alt and
Azi, forming one half of the pair. The other half is the current telescope
azimuth Theta and elevation Phi. With data from at least 2 stars, the optimal
rotation matrix can be found. Finding the optimal transformation matrix
given measured pairs of vectors is known as <em>Wahba’s problem</em>.</p>
<p>The solution to the problem here follows the algorithm laid out by Markley <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.
This method finds the optimal rotation matrix using singular value decomposition
(SVD). This method has been shown to reliably find the best pure rotation matrix
that connects the given data. Mathematically, given vectors <span class="math notranslate nohighlight">\(\vec{x}\)</span> and
<span class="math notranslate nohighlight">\(\vec{y} = R_{true} \vec{x}\)</span> we want to find <span class="math notranslate nohighlight">\(R_{opt}\)</span> by
minimizing the cost function</p>
<div class="math notranslate nohighlight">
\[L = \frac{1}{2} \sum_{i=1}^N \left|\vec{y}_i - R\vec{x}_i\right|^2\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the number of data points (stars). The data is combined in
a matrix defined by</p>
<div class="math notranslate nohighlight">
\[B = \sum_{i=1}^N w_i \vec{y}_i \otimes \vec{x}_i\]</div>
<p>where <span class="math notranslate nohighlight">\(\otimes\)</span> represents the outer product and the <span class="math notranslate nohighlight">\(w_i\)</span> are weights
that are normalized so that <span class="math notranslate nohighlight">\(\sum w_i = 1\)</span>. The SVD analysis finds the
closest pure rotation matrix to this matrix.</p>
<p>The SVD decomposition is written as</p>
<div class="math notranslate nohighlight">
\[B = U S V^T\]</div>
<p>where <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span> are orthogonal matrices and <span class="math notranslate nohighlight">\(S\)</span> is a digonal
matrix with compoents <span class="math notranslate nohighlight">\((s_1, s_2, s_3)\)</span> with  <span class="math notranslate nohighlight">\(s_1 \ge s_2 \ge s_3\)</span>.
The optimal rotation matrix is then given by</p>
<div class="math notranslate nohighlight">
\[R = U S^\prime V^T\]</div>
<p>where <span class="math notranslate nohighlight">\(S^\prime\)</span> is a diagonal matrix with compoents <span class="math notranslate nohighlight">\((1, 1, d)\)</span> where
<span class="math notranslate nohighlight">\(d = \det(U) \det(V) = \pm 1\)</span>.</p>
<p>The value of the cost function at the minimum is a kind of <span class="math notranslate nohighlight">\(\chi^2\)</span> and
is a function of the singular values</p>
<div class="math notranslate nohighlight">
\[L_{min} = 1 - s_1 - s_2 - d s_3\]</div>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>“Attitude Determination using Vector Observations and the Singular Value Decomposition”,
The Journal of Astronautical Sciences, Vol 36, No 3, July-September 1988, pp 245-258</p>
</aside>
</aside>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="installation.html"
                          title="previous chapter">Installation</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="code.html"
                          title="next chapter">The <code class="xref py py-mod docutils literal notranslate"><span class="pre">pushto</span></code> package</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/coords.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="code.html" title="The pushto package"
             >next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pushto 1.0.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Coordinate Transformations</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, Patrick Toale.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>